
!if $vote_option=anonymous
 ÕâÊÇÄäÃûÍ¶Æ±.
!else
 !if $vote_option=trace
   Ce questionnaire est anonyme et tracé.
 !else
   ÕâÊÇ¼ÇÃûÍ¶Æ±.
 !endif
!endif
!if $vote_status=2
 ÒÑ¾­¹Ø±Õ.
!endif

!if $wims_user=supervisor
 ($vcnt Æ±)
 !href cmd=reply&job=edit $wims_name_change
 
 !href cmd=reply&job=csv $wims_name_csv
<p>
!set wims_menu_items=!append line change,1,cmd=reply&job=edit\
 csv,1,cmd=reply&job=csv\
to $wims_menu_items
!endif

!if $vote_status=2
 !read $votedir/$vote.def
 !goto comments
!endif

!if $(user_vote_$Vote)!=$empty
 !if $vote_option!=nominative
  ÄãÒÑ¾­Í¶¹ıÆ±ÁË. <p>
 !else
  ÄãÒÑ¾­±íÊ¾¹ıÄãµÄÑ¡Ôñ, ²»¹ıÄã»¹¿ÉÒÔ¸Ä±äÖ÷Òâ.
  <p>
  !goto form
 !endif
!else
 ÄãµÄÑ¡Ôñ: <p>
 :form
 !form reply
 <input type=hidden name=job value=vote>
 !set m_formed=yes
!endif

!read $votedir/$vote.def

!if $m_formed=yes
 <p><center>
 <input type=submit value="$wims_name_tosave">
 </center></form>
!endif

:comments
!readdef $votedir/$vote.comments 
!if $wims_user=supervisor and $test_comment=1 and $vote_option!=nominative
<p><b>Textes des commentaires</b> : 
</p><p> 
!for i=1 to $parmcnt
 !if $(type_comment$i)=yes
  !set comment_$i = !replace internal --- by $\
 $<br>- in $(comment_$i)

 $i : 
 $(comment_$i)
 !set rcnt=!recordcnt $votedir/$(vote)_$i.comments
 !for r_j=1 to $rcnt
 <br>-
  !record $r_j of $votedir/$(vote)_$i.comments
 !next
</p><p>
 !endif
 </p>
!next
!endif
!if $wims_user=supervisor and $vote_option!=anonymous
 <p> Détail des enregistrements.
 !for i=1 to $parmcnt
  !for c=1 to $(choices$i)
   !if /supervisor/ notin $c/
    <p>$i-
    !item $c of $(chlist$i)
 <br> <tt>
    !for u in $(votes_$(i)_$c)
     !if $vote_option=nominative
      !set U=!translate internal / to , in $u
      !readproc adm/class/userdef classes,$U
      !defof user_lastname, user_firstname in $userdef
       ($u)
       <br>
     !else 
       ($u) 
     !endif
    !next u
   </tt>
   !endif
  !next c
 !next i
!endif
